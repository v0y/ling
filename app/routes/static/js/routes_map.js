// Generated by CoffeeScript 1.6.2
(function() {
  var drawRoutes, initializeMap;

  initializeMap = function() {
    var mapOptions;

    mapOptions = {
      center: new google.maps.LatLng(15, 15),
      zoom: 3,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    return new google.maps.Map($("#map-canvas")[0], mapOptions);
  };

  drawRoutes = function(routes, map) {
    var latlngbounds, mapPoints, point, polyline, pt, route, segment, _i, _j, _k, _len, _len1, _len2, _ref;

    latlngbounds = new google.maps.LatLngBounds();
    for (_i = 0, _len = routes.length; _i < _len; _i++) {
      route = routes[_i];
      _ref = route['segments'];
      for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
        segment = _ref[_j];
        mapPoints = [];
        for (_k = 0, _len2 = segment.length; _k < _len2; _k++) {
          point = segment[_k];
          pt = new google.maps.LatLng(point['lat'], point['lon']);
          mapPoints.push(pt);
          latlngbounds.extend(pt);
        }
        polyline = new google.maps.Polyline({
          path: mapPoints,
          editable: false,
          draggable: false,
          geodesic: true,
          strokeColor: '#FF0000',
          strokeOpacity: 1.0,
          strokeWeight: 2
        });
        polyline.setMap(map);
      }
    }
    return map.fitBounds(latlngbounds);
  };

  window.main = function(routesJSON) {
    var map;

    if (!$.isEmptyObject(routesJSON)) {
      map = initializeMap();
      return drawRoutes(routesJSON, map);
    }
  };

}).call(this);
